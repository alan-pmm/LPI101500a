#-- 101.1 Determine and configure hardware settings
#-- Shows all devices currently connected to the PCI (Peripheral Component Interconnect) bus.
#--command 'lspci' (Peripheral Component Interconnect) bus
alain@ubuntuserver22:~$ lspci
00:00.0 Host bridge: Intel Corporation 440FX - 82441FX PMC [Natoma] (rev 02)
00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]
00:01.1 IDE interface: Intel Corporation 82371AB/EB/MB PIIX4 IDE (rev 01)
00:02.0 VGA compatible controller: VMware SVGA II Adapter
00:03.0 Ethernet controller: Intel Corporation 82540EM Gigabit Ethernet Controll                                     er (rev 02)
00:04.0 System peripheral: InnoTek Systemberatung GmbH VirtualBox Guest Service
00:05.0 Multimedia audio controller: Intel Corporation 82801AA AC'97 Audio Contr                                     oller (rev 01)
00:06.0 USB controller: Apple Inc. KeyLargo/Intrepid USB
00:07.0 Bridge: Intel Corporation 82371AB/EB/MB PIIX4 ACPI (rev 08)
00:0b.0 USB controller: Intel Corporation 82801FB/FBM/FR/FW/FRW (ICH6 Family) US                                     B2 EHCI Controller
00:0d.0 SATA controller: Intel Corporation 82801HM/HEM (ICH8M/ICH8M-E) SATA Cont                                     roller [AHCI mode] (rev 02)

#--command 'lsusb' (Universal Serial Bus)

#--Lists USB (Universal Serial Bus) devices currently connected to the machine
alain@ubuntuserver22:~$ lsusb
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 002: ID 80ee:0021 VirtualBox USB Tablet
Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub


#--The command lspci shows more details about a specific device if its address is given with option -s
alain@ubuntuserver22:~$ lspci -s 00:01.0
00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]

#--more with, accompanied by the option combined -s -v
alain@ubuntuserver22:~$ lspci -s 00:01.0 -v
00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]
        Flags: bus master, medium devsel, latency 0

#--more again with, accompanied by the option combined -s -v
alain@ubuntuserver22:~$ lspci -s 00:01.0 -vv
00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx-
        Latency: 0
		
#-- verify which kernel module is in use for the specified device is provided by the option -k,
alain@ubuntuserver22:~$ lspci -s 00:01.0 -k
00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]

#--Command lsusb shows the available USB channels and the devices connected to them. like lspci option 
#  -v displays more detailed output. 
#  -d specific device can be selected for inspection by providing its ID

alain@ubuntuserver22:~$ lsusb -v -d 1d6b:0002
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Couldn't open device, some information will be missing
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
  idVendor           0x1d6b Linux Foundation
  idProduct          0x0002 2.0 root hub
  bcdDevice            5.15
  iManufacturer           3 Linux 5.15.0-88-generic ehci_hcd
  iProduct                2 EHCI Host Controller
  iSerial                 1 0000:00:0b.0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength       0x0019
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval              12

#--With option -t, command lsusb shows the current USB device mappings as a hierarchical tree -- page 7
alain@ubuntuserver22:~$ lsusb -t
/:  Bus 02.Port 1: Dev 1, Class=root_hub, Driver=ohci-pci/12p, 12M
    |__ Port 1: Dev 2, If 0, Class=Human Interface Device, Driver=usbhid, 12M
/:  Bus 01.Port 1: Dev 1, Class=root_hub, Driver=ehci-pci/12p, 480M

#--works also with lspci and -t option and -v option (optionally)

alain@ubuntuserver22:~$ lspci -vt
-[0000:00]-+-00.0  Intel Corporation 440FX - 82441FX PMC [Natoma]
           +-01.0  Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]
           +-01.1  Intel Corporation 82371AB/EB/MB PIIX4 IDE
           +-02.0  VMware SVGA II Adapter
           +-03.0  Intel Corporation 82540EM Gigabit Ethernet Controller
           +-04.0  InnoTek Systemberatung GmbH VirtualBox Guest Service
           +-05.0  Intel Corporation 82801AA AC'97 Audio Controller
           +-06.0  Apple Inc. KeyLargo/Intrepid USB
           +-07.0  Intel Corporation 82371AB/EB/MB PIIX4 ACPI
           +-0b.0  Intel Corporation 82801FB/FBM/FR/FW/FRW (ICH6 Family) USB2 EHCI Controller
           \-0d.0  Intel Corporation 82801HM/HEM (ICH8M/ICH8M-E) SATA Controller [AHCI mode]


#-- Not all devices have corresponding modules. 

alain@ubuntuserver22:~$ lsusb -s 1
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub

alain@ubuntuserver22:~$ lsusb -s 2
Bus 002 Device 002: ID 80ee:0021 VirtualBox USB Tablet

#-- Both Bus and Dev numbers should be given to the -s option of the lsusb command
alain@ubuntuserver22:~$ lsusb -s 2:2
Bus 002 Device 002: ID 80ee:0021 VirtualBox USB Tablet

#--We can find a lot of loaded kernel modules in a standard Linux, viewable using 'kmod' package
#--command 'lsmod' shows all currently loaded modules:

#  3 COLUMNS :
#  Module : Module name.
#  Size : Amount of RAM occupied by the module, in bytes.
#  Used by : Depending modules.

alain@ubuntuserver22:~$ lsmod | head -n 7
Module                  Size  Used by
vboxsf                 36864  0
vboxguest              45056  3 vboxsf
vboxvideo              28672  0
drm_vram_helper        24576  1 vboxvideo
drm_ttm_helper         16384  2 drm_vram_helper,vboxvideo
binfmt_misc            24576  1

# as long as they are not being used by a running process, command modprobe -r should be used.
alain@ubuntuserver22:~$ modprobe -r vboxguest
modprobe: FATAL: Module vboxguest is in use.

alain@ubuntuserver22:~$ modprobe -r drm_vram_helper
modprobe: FATAL: Module drm_vram_helper is in use.

alain@ubuntuserver22:~$ modprobe -r snd_ac97_codec
modprobe: FATAL: Module snd_ac97_codec is in use.

# command 'modinfo' shows a description, the file,the author, the license, the identification, the dependencies and the available parameters for the given module. Option -p will make command modinfo display all available parameters and ignore the other information.

alain@ubuntuserver22:~$ modinfo -p snd_ac97_codec
enable_loopback:Enable AC97 ADC/DAC Loopback Control (bool)
power_save:Automatic power-saving timeout (in second, 0 = disable). (int)

# command 'modinfo' without option

alain@ubuntuserver22:~$ modinfo snd_ac97_codec
filename:       /lib/modules/5.15.0-88-generic/kernel/sound/pci/ac97/snd-ac97-codec.ko
license:        GPL
description:    Universal interface for Audio Codec '97
author:         Jaroslav Kysela <perex@perex.cz>
srcversion:     1FD0F36AF953EF83BBC58CD
depends:        snd,snd-pcm,ac97_bus
retpoline:      Y
intree:         Y
name:           snd_ac97_codec
vermagic:       5.15.0-88-generic SMP mod_unload modversions
sig_id:         PKCS#7
signer:         Build time autogenerated kernel key
sig_key:        1E:90:54:F5:F2:F5:58:6D:E9:90:EB:09:88:88:6A:2E:8D:1A:E8:0B
sig_hashalgo:   sha512
signature:      59:7E:4C:9A:3E:B7:28:93:80:B0:CE:2A:63:68:02:B1:07:DD:CC:A4:
                2C:DB:3D:56:75:6E:03:25:B5:94:32:3D:D6:93:58:2D:F6:3F:15:C7:
  .....
parm:           enable_loopback:Enable AC97 ADC/DAC Loopback Control (bool)
parm:           power_save:Automatic power-saving timeout (in second, 0 = disable). (int)



alain@ubuntuserver22:~$ ls /etc/modprobe.d/
amd64-microcode-blacklist.conf  blacklist-firewire.conf      intel-microcode-blacklist.conf
blacklist-ath_pci.conf          blacklist-framebuffer.conf   iwlwifi.conf
blacklist.conf                  blacklist-rare-network.conf  mdadm.conf
